<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Ullrika Sahlin, Zheng Zhou, Dawei Tang">

<title>RH3_uncertainty - Tiered approaches to characterise uncertainty in NGRA exemplified with a risk assessment</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">RH3_uncertainty</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./hazard example.html" rel="" target="">
 <span class="menu-text">Hazard</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./risk example.html" rel="" target="" aria-current="page">
 <span class="menu-text">Risk</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#assessment" id="toc-assessment" class="nav-link" data-scroll-target="#assessment">Assessment</a>
  <ul class="collapse">
  <li><a href="#hazard-assessment" id="toc-hazard-assessment" class="nav-link" data-scroll-target="#hazard-assessment">Hazard assessment</a></li>
  <li><a href="#exposure-assessment" id="toc-exposure-assessment" class="nav-link" data-scroll-target="#exposure-assessment">Exposure assessment</a></li>
  <li><a href="#risk-characterisation" id="toc-risk-characterisation" class="nav-link" data-scroll-target="#risk-characterisation">Risk characterisation</a></li>
  </ul></li>
  <li><a href="#practical-certainty" id="toc-practical-certainty" class="nav-link" data-scroll-target="#practical-certainty">Practical certainty</a></li>
  <li><a href="#a-tiered-approach-with-uncertainty-analysis" id="toc-a-tiered-approach-with-uncertainty-analysis" class="nav-link" data-scroll-target="#a-tiered-approach-with-uncertainty-analysis">A tiered approach with uncertainty analysis</a>
  <ul class="collapse">
  <li><a href="#step-1.1" id="toc-step-1.1" class="nav-link" data-scroll-target="#step-1.1">Step 1.1</a>
  <ul class="collapse">
  <li><a href="#identify-sources-of-uncertainty" id="toc-identify-sources-of-uncertainty" class="nav-link" data-scroll-target="#identify-sources-of-uncertainty">Identify sources of uncertainty</a></li>
  <li><a href="#evaluate-the-combined-impact-of-sources-of-uncertainty-on-the-outcome-of-interest" id="toc-evaluate-the-combined-impact-of-sources-of-uncertainty-on-the-outcome-of-interest" class="nav-link" data-scroll-target="#evaluate-the-combined-impact-of-sources-of-uncertainty-on-the-outcome-of-interest">Evaluate the combined impact of sources of uncertainty on the outcome of interest</a></li>
  <li><a href="#report-uncertainty-in-the-conclusion" id="toc-report-uncertainty-in-the-conclusion" class="nav-link" data-scroll-target="#report-uncertainty-in-the-conclusion">Report uncertainty in the conclusion</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#basic-option" id="toc-basic-option" class="nav-link" data-scroll-target="#basic-option">Basic option</a></li>
  <li><a href="#refined-option-with-probability-bounds" id="toc-refined-option-with-probability-bounds" class="nav-link" data-scroll-target="#refined-option-with-probability-bounds">Refined option with probability bounds</a></li>
  <li><a href="#refined-option-with-probability-distributions" id="toc-refined-option-with-probability-distributions" class="nav-link" data-scroll-target="#refined-option-with-probability-distributions">Refined option with probability distributions</a>
  <ul class="collapse">
  <li><a href="#reference-point" id="toc-reference-point" class="nav-link" data-scroll-target="#reference-point">Reference Point</a></li>
  <li><a href="#high-exposure" id="toc-high-exposure" class="nav-link" data-scroll-target="#high-exposure">High Exposure</a></li>
  <li><a href="#risk" id="toc-risk" class="nav-link" data-scroll-target="#risk">Risk</a></li>
  </ul></li>
  <li><a href="#conclusions" id="toc-conclusions" class="nav-link" data-scroll-target="#conclusions">Conclusions</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tiered approaches to characterise uncertainty in NGRA exemplified with a risk assessment</h1>
<p class="subtitle lead">Work in progress RiskHunt3R</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Ullrika Sahlin, Zheng Zhou, Dawei Tang </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="overview" class="level1">
<h1>Overview</h1>
<p>The aim of an uncertainty analysis is to identify sources of uncertainty and evaluate their combined impact on the experts uncertainty in the outcome of interest.</p>
<p>This page describe an approach to quantify uncertainty when risk is assessed by combining continuous quantities on hazard and exposure.</p>
<p>A tiered uncertainty analysis can be</p>
<ul>
<li><p>an expert judgement on the outcome of interest directly</p></li>
<li><p>a probability bound analysis, where uncertainty associated with the hazard and exposure as assessed separately as probability bounds, which are then combined by probability bound analysis. The results feed into expert judgement on the outcome of interest taking into account additional sources of uncertainty than those considered in the hazard and exposure part.</p></li>
<li><p>a full probabilistic analysis, where uncertainty associated with the hazard and exposure as assessed separately as probability distributions, which are then combined by Monte Carlo simulation. The results feed into expert judgement on the outcome of interest taking into account additional sources of uncertainty than those considered in the hazard and exposure part.</p></li>
</ul>
</section>
<section id="assessment" class="level1">
<h1>Assessment</h1>
<p>Consider a human health risk assessment of chemical <span class="math inline">\(X\)</span>.</p>
<section id="hazard-assessment" class="level2">
<h2 class="anchored" data-anchor-id="hazard-assessment">Hazard assessment</h2>
<p>The quantity of interest for the hazard assessment is the Point of Departure, <strong>PoD</strong>.</p>
<p>As an example, a PoD of 3 μg <span class="math inline">\(X\)</span>/kg bw per day was identified by the experts as the BMDL from a model average of BMD modelling for a relevant human effect.</p>
<p>Model Averaged BMD model</p>
<table class="table">
<thead>
<tr class="header">
<th>BMDL</th>
<th>BMD</th>
<th>BMDU</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>3</td>
<td>10</td>
<td>15</td>
</tr>
</tbody>
</table>
</section>
<section id="exposure-assessment" class="level2">
<h2 class="anchored" data-anchor-id="exposure-assessment">Exposure assessment</h2>
<p>The quantity of interest for the exposure assessment is a High Exposure in the target population, <strong>HE</strong>.</p>
<p>The range (seen over different populations and data sets) of the exposure estimates for <span class="math inline">\(X\)</span> was assessed as</p>
<ul>
<li>2 - 4 μg/kg bw per day for a high-level exposure scenario.</li>
</ul>
</section>
<section id="risk-characterisation" class="level2">
<h2 class="anchored" data-anchor-id="risk-characterisation">Risk characterisation</h2>
<p>The question for the risk assessment is if the High Exposure is exceeding the Reference Point, i.e.</p>
<p><span class="math display">\[HE &gt; PoD\]</span></p>
<p>A ratio <span class="math inline">\(\frac{HE}{PoD}\)</span> less than 1 implies a low risk.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>When the PoD is derived from BMD modelling, a ratio greater than 1 implies that the exposure can be associated with a 5% increase relative to the background incidence for the effect. Note that the value 5% comes from the BMD modelling.</p>
</div>
</div>
</section>
</section>
<section id="practical-certainty" class="level1">
<h1>Practical certainty</h1>
<p>The practical certainty is by risk managers set to be 66% probability to conclude that compound <span class="math inline">\(X\)</span> is a risk and 80% probability to conclude that compound <span class="math inline">\(X\)</span> is not a risk. The assessment is <em>inconclusive</em> for any uncertainty in between the limits.</p>
<p>It can be sufficient to conclude if uncertainty the conclusion is in the range of practical certainty.</p>
<table class="table">
<colgroup>
<col style="width: 30%">
<col style="width: 43%">
<col style="width: 26%">
</colgroup>
<thead>
<tr class="header">
<th>Health concern</th>
<th>Inconclusive</th>
<th>No health concern</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>&lt;20%</td>
<td>20 - 0.66</td>
<td>&gt;0.66%</td>
</tr>
</tbody>
</table>
<p>If not, the assessment should be reported as <strong>inconclusive</strong>. The risk managers can then decide to support generation of new studies to <strong>reduce</strong> uncertainty by collecting more data or perform a re-evaluation of the risk assessment with a more <strong>refined</strong> characterisation of uncertainty.</p>
</section>
<section id="a-tiered-approach-with-uncertainty-analysis" class="level1">
<h1>A tiered approach with uncertainty analysis</h1>
<section id="step-1.1" class="level2">
<h2 class="anchored" data-anchor-id="step-1.1">Step 1.1</h2>
<section id="identify-sources-of-uncertainty" class="level3">
<h3 class="anchored" data-anchor-id="identify-sources-of-uncertainty">Identify sources of uncertainty</h3>
<p>Sources of uncertainty have been identified related to inputs and methods in the parts of the assessment, i.e.&nbsp;related to:</p>
<ul>
<li>Chemical characterization and analytical methods</li>
<li>Hazard identification and characterisation</li>
<li>Exposure assessment</li>
<li>Risk characterisation</li>
</ul>
<p>Sources of uncertainty can be summarised as tables with explanations and indications on their influence on the overall uncertainty (qualitative expressions).</p>
</section>
<section id="evaluate-the-combined-impact-of-sources-of-uncertainty-on-the-outcome-of-interest" class="level3">
<h3 class="anchored" data-anchor-id="evaluate-the-combined-impact-of-sources-of-uncertainty-on-the-outcome-of-interest">Evaluate the combined impact of sources of uncertainty on the outcome of interest</h3>
<p>There are several options to evaluate the combined impact of all these sources of uncertainty on the conclusion whether the MOE is greater than 1.</p>
<p>A tiered uncertainty analysis is done in several steps</p>
<ol type="1">
<li>Basic option</li>
<li>Refined option with uncertainty expressed by probability bounds</li>
<li>Refined options with uncertainty expressed by probability distributions</li>
</ol>
</section>
<section id="report-uncertainty-in-the-conclusion" class="level3">
<h3 class="anchored" data-anchor-id="report-uncertainty-in-the-conclusion">Report uncertainty in the conclusion</h3>
<p>Formulate the conclusion as % certainty for the more probable outcome.</p>
<p>Check if the % certainty for the more probable outcome is in the region of practical certainty.</p>
</section>
</section>
</section>
<section id="basic-option" class="level1">
<h1>Basic option</h1>
<p>The basic option for uncertainty analysis is to assess the combined impact in a single step using expert judgement. This is done by asking the experts to agree how certain they are as a group that the MOE is greater than 1, given that all identified (non-standard or standard) sources of uncertainty has been resolved.</p>
<p>This can be done by reaching a consensus judgement, following procedures for expert knowledge elicitation (using behavioural aggregation to allow for discussions). This judgement requires expertise on both toxicity and exposure assessment.</p>
<p>This is a useful option when the Highest Exposure is far below the Reference Point.</p>
</section>
<section id="refined-option-with-probability-bounds" class="level1">
<h1>Refined option with probability bounds</h1>
<p>A refined approach is needed when there is a small difference between the Reference Point and the Highest Exposure.</p>
<p>A refined option is to assess uncertainties separately before combining them by calculations and assessing overall uncertainty.</p>
<p>First we explore how to do this with <strong>probability bound analysis</strong>.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Probabilities first</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Numbers first</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>The refined option with probability bounds can be modified to consider practical certainty. In this example, the risk managers and the experts have agreed that experts must be at least 0.66% certain that a High Exposure <span class="math inline">\(HE\)</span> is below the Reference Point <span class="math inline">\(PoD\)</span> in order for risk managers to make a decision.</p>
<p>This means that the assessment is conclusive when the experts are at least 0.66% certain that there is a health concern or that they are at least 0.66% certain that there is not a health concern.</p>
<p>Subtract the probability threshold for practical certainty from 100% to set an upper bound for the the sum of the lost probabilities.</p>
<p><span class="math display">\[100\% - 0.66\% = 99.34\%\]</span></p>
<p>Divide the resulting probability into two parts, one for hazard and one for exposure, here <span class="math inline">\(5\%\)</span> and <span class="math inline">\(100-0.66 - 5 = 94.34\%\)</span>.</p>
<p>Subtract the lost probability for hazard from 100, to set the probability required for a conservative estimate of the Reference Point.</p>
<p><span class="math display">\[100\% - 5\% = 95\%\]</span></p>
<p>Elicit a conservative estimate of the Reference Point (or PoD/UF) from the toxicology experts (asking them to consider the identified sources of uncertainty for the hazard assessment). Define the conservative estimate as the quantile <span class="math inline">\(y\)</span></p>
<p><span class="math display">\[P(PoD &lt; y) = 95\%\]</span></p>
<p>Subtract the lost probability for exposure from 100, to set the probability required for a conservative estimate of a High Exposure.</p>
<p><span class="math display">\[100\% - 94.34\% = 5.66\%\]</span></p>
<p>Elicit a conservative estimate of a High Exposure from the exposure experts (asking them to consider the identified sources of uncertainty for the exposure assessment). Define the conservative estimate as the quantile <span class="math inline">\(x\)</span></p>
<p><span class="math display">\[P(HE &lt; x) = 5.66\%\]</span></p>
<p>Divide the conservative estimate for the exposure with the conservative estimate for the hazard <span class="math inline">\(\frac{x}{y}\)</span>.</p>
<p>If the ratio is less than the threshold on MOE, then there is sufficient certainty for a firm conclusion that exposure is below the hazardous concentration. I.e. is <span class="math inline">\(\frac{x}{y} &lt; 1\)</span>?</p>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Use a conservative estimate for PoD as starting point and use experts judgement on their uncertainty for that to guide what value to consider for the exposure part.</p>
<p>Ask experts to judge their probability expressing their uncertainty about a conservative estimate of hazard, e.g.&nbsp;the BMDL,</p>
<p><span class="math display">\[y = 3\]</span></p>
<p>The experts judge that they are 95% certain that the Reference Point is above 3 μg <span class="math inline">\(X\)</span>/kg bw per day.</p>
<p><span class="math display">\[P(PoD &gt; y) = 95\%\]</span></p>
<table class="table">
<thead>
<tr class="header">
<th>P below</th>
<th>value</th>
<th>P above</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>5%</td>
<td>y</td>
<td>95%</td>
</tr>
</tbody>
</table>
<p>In some situations, the PoD is the BMDL and then it is difficult to talk about uncertainty about the PoD. If so, one can introduce an uncertainty factor (UF) that considers uncertainty associated with the hazard assessment. The focus is then on PoD/UF instead of PoD.</p>
<p><span class="math display">\[P(PoD &gt; y) = 95\%\]</span></p>
<p>Find a value on a High Exposure where the MOE is at the critical threshold set by risk managers</p>
<p><span class="math display">\[\frac{x}{y} = 1\]</span></p>
<p><span class="math display">\[x = 1 \cdot y = 3\]</span></p>
<p>Ask the experts to judge their probability that a High Exposure is below 3 μg <span class="math inline">\(X\)</span>/kg bw per day.</p>
<p><span class="math display">\[P( HE &lt; x) = 95\%\]</span></p>
<table class="table">
<thead>
<tr class="header">
<th>P below</th>
<th>value</th>
<th>P above</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>95%</td>
<td>x</td>
<td>5%</td>
</tr>
</tbody>
</table>
<p>Check if practical certainty has been obtained, i.e.&nbsp;if <span class="math inline">\(100 - [(100-P(HE &lt; x)) + (100-P(PoD &gt; y))] \geq 0.66\%\)</span></p>
<p><span class="math display">\[100-[5+5]=100-10=90\]</span></p>
<!-- Probability bounds analysis (and the rule of "lost probabilities") allows us to calculate that it is at least  -->
<!-- $$ 100 - [(100-95)+(100-95)]=90\%$$  -->
<!-- probable that the ratio of the highest estimate of High Exposure to the Reference Point is less than or equal than 4/3 = 1.33 -->
<!-- $$P(\frac{HE}{PoD} < 1.33) \geq 90\%$$ -->
<!-- | P below            | value                | P above               | -->
<!-- |--------------------|----------------------|-----------------------| -->
<!-- | $\leq 10\%$| 1.33|$\geq 90\%$| -->
<!-- See if a conclusion can be made. If the value 1.33 is less than 1 and the probability is above the practical certainty 0.66, then result is enough to reach a conclusion whether a High Exposure is below the Reference Point (i.e. that the MOE is greater than 1).  -->
</div>
</div>
</div>
<p>If it is not possible to conclude with high enough certainty, we move on to a refined option for uncertainty analysis with probability distributions or consider collecting more data.</p>
</section>
<section id="refined-option-with-probability-distributions" class="level1">
<h1>Refined option with probability distributions</h1>
<p>A refined option can alternatively be done with with probability distributions which are combined by Monte Carlo simulation.</p>
<p>This is an option, when the outcome of a probability bound analysis was not conclusive.</p>
<p>It can also be an option when the assessors prefers to choose to justify probability distributions for uncertainty from available information, combine uncertainties by performing the probability calculations, and then ask the experts to make a judgement on the outcome of interest directly. Note that an explicit elicitation of the outcome of interest following the Monte Carlo simulation is a condition for this approach to result in a characterisation of the experts uncertainty considering the combined impact of all sources of uncertainty in the assessment.</p>
<section id="reference-point" class="level3">
<h3 class="anchored" data-anchor-id="reference-point">Reference Point</h3>
<p>A probability distribution representing uncertainty in the <strong>Reference Point</strong> can be taken from the BMD uncertainty distribution generated by bootstrapping or Bayesian modelling.</p>
<p>We let the BMDL, the BMD, and the BMDU define the 5th percentile (P05), the median (P50), and the 95th percentile (P95) of the probability distribution for uncertainty in the PoD.</p>
<table class="table">
<thead>
<tr class="header">
<th>BMDL</th>
<th>BMD</th>
<th>BMDU</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>P05</td>
<td>P50</td>
<td>P95</td>
</tr>
<tr class="even">
<td>3</td>
<td>10</td>
<td>15</td>
</tr>
</tbody>
</table>
<p>The lower bound is zero. Since the distribution is skewed to the right we set an upper plausible bound. Here we fit a beta distribution using the SHELF R-package.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> SHELF<span class="sc">::</span><span class="fu">fitdist</span>(<span class="at">vals =</span> <span class="fu">c</span>(bmdl,bmd,bmdu),<span class="at">probs =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="fl">0.95</span>), <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper=</span> bmdu<span class="sc">*</span><span class="fl">1.2</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>SHELF<span class="sc">::</span><span class="fu">plotfit</span>(fit,<span class="at">d=</span><span class="st">"beta"</span>,<span class="at">xlab=</span><span class="st">"PoD"</span>,<span class="at">ylab=</span><span class="st">"probability density"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="risk-example_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>An alternative is to go to the online elicitation app for one distribution <a href="https://jeremy-oakley.shinyapps.io/SHELF-single/">link to SHELF app</a> and find a probability distribution that matches these quantiles. Note that you have to specify the lower and upper bound of the plausible range. You can get them from studying the sample from BMD modelling. You can find the R-code to generate random numbers from the selected probability distribution in the report that is possible to download from SHELF</p>
</div>
</div>
<p>The beta-distribution is defined as</p>
<p><span class="math display">\[\frac{PoD}{18} \sim beta(3.09, 2.58)\]</span></p>
<p>We sample from it using this function</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sample_PoD <span class="ot">&lt;-</span> <span class="cf">function</span>(niter){</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  fit<span class="sc">$</span>limits<span class="sc">$</span>lower <span class="sc">+</span> (fit<span class="sc">$</span>limits<span class="sc">$</span>upper<span class="sc">-</span>fit<span class="sc">$</span>limits<span class="sc">$</span>lower) <span class="sc">*</span> <span class="fu">rbeta</span>(<span class="at">n =</span> niter, <span class="at">shape1 =</span> fit<span class="sc">$</span>Beta<span class="sc">$</span>shape1, <span class="at">shape2 =</span> fit<span class="sc">$</span>Beta<span class="sc">$</span>shape2)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<!-- # ```{r} -->
<!-- # library(ggplot2) -->
<!-- #  -->
<!-- # pp = ppoints(200) -->
<!-- # qq = qbeta(pp,3.15,1.92) -->
<!-- # dd = dbeta(qq,3.15,1.92) -->
<!-- #  -->
<!-- # ggplot(data.frame(PoD = qq, density = dd), -->
<!-- #        aes(x=PoD, y=density)) +  -->
<!-- #   geom_line() + -->
<!-- #   ggtitle("Uncertainty in the Reference Point") -->
<!-- #  -->
<!-- # ``` -->
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>This approach ignores additional sources of uncertainty than those considered in the model, hence we need to draft how to consider those as well. e.g.&nbsp;by adjusting the specification of the quantiles.</p>
</div>
</div>
</section>
<section id="high-exposure" class="level3">
<h3 class="anchored" data-anchor-id="high-exposure">High Exposure</h3>
<p>A probability distribution representing uncertainty in the estimates of High Exposure over different surveys can be specified by assuming that the range of the dietary exposure estimates corresponds to the bounds of an 80% probability interval.</p>
<table class="table">
<thead>
<tr class="header">
<th>min HE</th>
<th>max HE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>P10</td>
<td>P90</td>
</tr>
<tr class="even">
<td>2</td>
<td>4</td>
</tr>
</tbody>
</table>
<p>One choice could be to use a normal distribution to represent uncertainty in a High Exposure. A normal distribution has two parameters, the mean (<span class="math inline">\(\mu\)</span>) and the standard deviation (<span class="math inline">\(\sigma\)</span>).</p>
<p><span class="math display">\[HE \sim N(\mu,\sigma)\]</span></p>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>The normal distributions is not an ideal choice for a non-negative variable. There is no default distribution and it is important that it represents experts uncertainty about a high exposure.</p>
<p>The choice of probability distribution could be guided by more detailed information, paired averages and P95s from different populations groups.</p>
</div>
</div>
<p>We derive the mean by taking the mid value in the range</p>
<p><span class="math display">\[ \mu = \frac{4+2}{2}= 3\]</span> The standard deviation is specified by considering the formula for a 90% quantile in the normal distributions as a function of the parameters.</p>
<p><span class="math display">\[ P90 = \mu + 1.28\cdot \sigma\]</span></p>
<p>and rearranging it to be a function of <span class="math inline">\(\sigma\)</span></p>
<p><span class="math display">\[ \sigma = \frac{P90 - \mu}{1.28} =  \frac{4-1}{1.28}=0.78\]</span></p>
<p>Specification of the parameters and draw of random numbers from the normal distribution.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>sample_HE <span class="ot">&lt;-</span> <span class="cf">function</span>(niter){</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> (hel<span class="sc">+</span>heu)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">=</span> (heu<span class="sc">-</span>m)<span class="sc">/</span><span class="fu">qnorm</span>(<span class="fl">0.9</span>)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>he <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="at">n =</span> niter, <span class="at">mean =</span> m, <span class="at">sd =</span> s)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>he[he<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">=</span> <span class="dv">0</span> <span class="co"># truncate</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(he)</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="risk" class="level3">
<h3 class="anchored" data-anchor-id="risk">Risk</h3>
<section id="combine-sources-of-uncertainty-by-calculations" class="level4">
<h4 class="anchored" data-anchor-id="combine-sources-of-uncertainty-by-calculations">Combine sources of uncertainty by calculations</h4>
<p>Evaluate the combined impact of the characterised uncertainty in PoD and HE on the MOE by Monte Carlo simulation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>niter <span class="ot">=</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>pod <span class="ot">&lt;-</span> <span class="fu">sample_PoD</span>(niter)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>he <span class="ot">&lt;-</span> <span class="fu">sample_HE</span>(niter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The distributions for High Exposure and the Reference Point overlap.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="risk-example_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The calculated probability that the MOE is above 1 is 97 %.</p>
<p>This value was derived by calculating the proportion of random samples in your Monte Carlo simulation that corresponds to a MOE &gt; 1.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>moe <span class="ot">=</span> pod<span class="sc">/</span>he</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(moe<span class="sc">&gt;</span><span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>One way to visualise the resulting distribution for uncertainty in MOE is</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="risk-example_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>where the red area corresponds to a MOE greater than 1.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Alternative way to summarise when not using MOE</p>
<p>If risk is evaluated based on the outcome that the High Exposure is exceeding the Reference Point, then the probability to be calculated is</p>
<p><span class="math display">\[P(\frac{HE}{PoD}&gt;1)\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>risk_ratio <span class="ot">=</span> he<span class="sc">/</span>pod</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(risk_ratio <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output-display">
<p><img src="risk-example_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In this visualisation, the red area corresponds to a High Exposure greater than the Reference Point.</p>
</div>
</div>
</section>
<section id="consider-additional-sources-of-uncertainty" class="level4">
<h4 class="anchored" data-anchor-id="consider-additional-sources-of-uncertainty">Consider additional sources of uncertainty</h4>
<p>As a final step, the experts are invited to adjust this probability upwards or downwards considering <strong>additional sources of uncertainty</strong>, not previously taken into account in the analysis.</p>
<p>For the purpose of this exercise we assume that the experts subsequently judged that any additional sources of uncertainty were small enough that there was no need to adjust the calculated % probability that the MOE is above 1.</p>
<p>An additional sources of uncertainty could e.g.&nbsp;be the choice of distributions used in the Monte Carlo simulation and any limitations in the quality of the exposure and toxicity data that are not taken into account in those distributions.</p>
<p>The % certainty for the more probable outcome is 97%. Check if it is in the region of practical certainty (i.e.&nbsp;&lt;99.34% or &gt;0.66%).</p>
</section>
</section>
</section>
<section id="conclusions" class="level1">
<h1>Conclusions</h1>
<p>Bayesian reasoning combined with Probability bounds analysis can be used for categorical as well as contiuous quantities.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>